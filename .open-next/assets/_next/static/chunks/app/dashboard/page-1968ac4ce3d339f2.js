(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1100:(e,s,t)=>{Promise.resolve().then(t.bind(t,3025))},3025:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var a=t(5155),n=t(2115),l=t(7415),i=t(6714),r=t(8748),o=t(7808),d=t(4860),c=t(3902),u=t(5787),m=t(970),x=t(1053),f=t(3375),h=t(2345);let g=(0,t(1847).A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var j=t(6191),p=t(5882),y=t(7003),v=t(63);function b(){var e,s,t,b,N;let w=(0,v.useRouter)(),[_,A]=(0,n.useState)([]),[k,C]=(0,n.useState)({}),[S,O]=(0,n.useState)(null),[z,L]=(0,n.useState)(!1),[P,E]=(0,n.useState)(!1),[M,V]=(0,n.useState)(!1),[I,D]=(0,n.useState)(!0);(0,n.useEffect)(()=>{$()},[]);let $=async()=>{D(!0);let e=await (0,m.O)();e.loans&&A(e.loans),D(!1)},F=async e=>{let s=await (0,x.k)(e);s.payments&&C(t=>({...t,[e]:s.payments}))},H=e=>{O(_.find(s=>s.id===e)||null),F(e),L(!0)},R=e=>{O(_.find(s=>s.id===e)||null),F(e),E(!0)},q=async e=>{S&&(await (0,h.n)({...e,loanId:S.id})).success&&(await $(),S&&await F(S.id))},B=async e=>{let s=await (0,f.D)({borrower_email:e.borrower_email,amount:e.amount,issue_date:e.issue_date,due_date:e.due_date,notes:e.notes});return s.success?(await $(),{success:!0}):(console.error("Create loan failed:",s.error),{success:!1,error:s.error})},G=_.reduce((e,s)=>e+s.remaining_amount,0),J=(null==(s=k[null==(t=_[0])?void 0:t.id])||null==(e=s[0])?void 0:e.amount)||0,K=(null==(N=_[0])||null==(b=N.profiles)?void 0:b.full_name)||void 0;return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,a.jsx)(l.A,{}),(0,a.jsxs)("main",{className:"max-w-[1200px] mx-auto px-6 py-8 flex-1 w-full",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-extrabold tracking-tight text-foreground",children:"Dashboard"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"Overview of your lending activities"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(y.$,{variant:"outline",onClick:()=>w.push("/dashboard/loans"),children:[(0,a.jsx)(g,{className:"size-4 mr-2"}),"View All Loans"]}),(0,a.jsxs)(y.$,{onClick:()=>{V(!0)},children:[(0,a.jsx)(j.A,{className:"size-4 mr-2"}),"Add New Loan"]})]})]}),(0,a.jsx)(o.A,{totalOwed:G,activeLoans:_.length,latestPayment:J,latestPaymentFrom:K}),I?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading dashboard..."})}):0===_.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-border rounded-xl p-12 min-h-[400px]",children:[(0,a.jsx)("div",{className:"size-12 rounded-full bg-muted flex items-center justify-center text-muted-foreground mb-4",children:(0,a.jsx)(p.A,{className:"size-6"})}),(0,a.jsx)("p",{className:"font-bold text-foreground text-lg",children:"No loans yet"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center mt-2",children:"Start by creating your first loan to track lending activities."})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.slice(0,6).map(e=>(0,a.jsx)(r.A,{loan:e,onLogPayment:H,onViewHistory:R},e.id))})]}),(0,a.jsx)(i.A,{}),z&&S&&(0,a.jsx)(d.A,{isOpen:z,onClose:()=>L(!1),loanId:S.id,remainingAmount:S.remaining_amount,onSubmit:q}),P&&S&&(0,a.jsx)(c.A,{isOpen:P,onClose:()=>E(!1),loanId:S.id,amount:S.amount,remainingAmount:S.remaining_amount,payments:k[S.id]||[],onAddPayment:()=>{E(!1),L(!0)}}),M&&(0,a.jsx)(u.A,{isOpen:M,onClose:()=>V(!1),onSubmit:B})]})}}},e=>{e.O(0,[619,108,843,441,255,358],()=>e(e.s=1100)),_N_E=e.O()}]);
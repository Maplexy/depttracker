(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[453],{185:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var n=s(5155),r=s(2115),a=s(7415),i=s(6714),l=s(8748),o=s(7808),d=s(4860),c=s(3902),m=s(5787),u=s(970),x=s(1053),f=s(3375),g=s(2345),p=s(6191),h=s(5882),j=s(7003);function b(){var e,t,s,b,y;let[N,v]=(0,r.useState)([]),[w,_]=(0,r.useState)({}),[A,S]=(0,r.useState)(null),[k,C]=(0,r.useState)(!1),[O,L]=(0,r.useState)(!1),[z,P]=(0,r.useState)(!1),[E,I]=(0,r.useState)(!0);(0,r.useEffect)(()=>{M()},[]);let M=async()=>{I(!0);let e=await (0,u.O)();e.loans&&v(e.loans),I(!1)},D=async e=>{let t=await (0,x.k)(e);t.payments&&_(s=>({...s,[e]:t.payments}))},F=e=>{S(N.find(t=>t.id===e)||null),D(e),C(!0)},H=e=>{S(N.find(t=>t.id===e)||null),D(e),L(!0)},V=async e=>{A&&(await (0,g.n)({...e,loanId:A.id})).success&&(await M(),A&&await D(A.id))},$=()=>{P(!0)},q=async e=>{let t=await (0,f.D)({borrower_email:e.borrower_email,amount:e.amount,issue_date:e.issue_date,due_date:e.due_date,notes:e.notes});return t.success?(await M(),{success:!0}):(console.error("Create loan failed:",t.error),{success:!1,error:t.error})},B=N.reduce((e,t)=>e+t.remaining_amount,0),G=(null==(t=w[null==(s=N[0])?void 0:s.id])||null==(e=t[0])?void 0:e.amount)||0,J=(null==(y=N[0])||null==(b=y.profiles)?void 0:b.full_name)||void 0;return(0,n.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,n.jsx)(a.A,{}),(0,n.jsxs)("main",{className:"max-w-[1200px] mx-auto px-6 py-8 flex-1 w-full",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-extrabold tracking-tight text-foreground",children:"My Loans"}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage and track your private lending activities with friends."})]}),(0,n.jsxs)(j.$,{onClick:$,children:[(0,n.jsx)(p.A,{className:"size-4 mr-2"}),"Add New Loan"]})]}),(0,n.jsx)(o.A,{totalOwed:B,activeLoans:N.length,latestPayment:G,latestPaymentFrom:J}),E?(0,n.jsx)("div",{className:"text-center py-12",children:(0,n.jsx)("p",{className:"text-muted-foreground",children:"Loading loans..."})}):0===N.length?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-border rounded-xl p-12 min-h-[400px]",children:[(0,n.jsx)("div",{className:"size-12 rounded-full bg-muted flex items-center justify-center text-muted-foreground mb-4",children:(0,n.jsx)(h.A,{className:"size-6"})}),(0,n.jsx)("p",{className:"font-bold text-foreground text-lg",children:"No loans yet"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground text-center mt-2",children:"Start by creating your first loan to track lending activities."})]}):(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[N.map(e=>(0,n.jsx)(l.A,{loan:e,onLogPayment:F,onViewHistory:H},e.id)),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-border rounded-xl p-6 min-h-[340px] hover:border-primary/50 transition-all cursor-pointer group",onClick:$,children:[(0,n.jsx)("div",{className:"size-12 rounded-full bg-muted flex items-center justify-center text-muted-foreground group-hover:text-primary group-hover:bg-primary/10 transition-colors mb-4",children:(0,n.jsx)(p.A,{className:"size-6"})}),(0,n.jsx)("p",{className:"font-bold text-foreground",children:"Create New Loan"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground text-center mt-1",children:"Set up a new lending record for a friend or family member."})]})]})]}),(0,n.jsx)(i.A,{}),k&&A&&(0,n.jsx)(d.A,{isOpen:k,onClose:()=>C(!1),loanId:A.id,remainingAmount:A.remaining_amount,onSubmit:V}),O&&A&&(0,n.jsx)(c.A,{isOpen:O,onClose:()=>L(!1),loanId:A.id,amount:A.amount,remainingAmount:A.remaining_amount,payments:w[A.id]||[],onAddPayment:()=>{L(!1),C(!0)}}),z&&(0,n.jsx)(m.A,{isOpen:z,onClose:()=>P(!1),onSubmit:q})]})}},5824:(e,t,s)=>{Promise.resolve().then(s.bind(s,185))}},e=>{e.O(0,[619,108,843,441,255,358],()=>e(e.s=5824)),_N_E=e.O()}]);